{% extends "database/base.html" %}
{% block content %}
    <br><br>

    {{ data|json_script:"data_json" }}

    <div class="container">
        <div class="row" style="background-color:#F1F1EF">
          <div class="col">
            <div style="line-height: 135%"><br></div>
            <h5>Explore Solar Projects</h5>in Virginia

            <div style="line-height: 185%"><br></div>
            
            <div class="dropdown">
                <button class="btn btn-sm dropdown-toggle" style="width: 240px; text-align: left; border: 0.8px solid #000000; background-color: #ffffff;" data-toggle="dropdown">
                    &#160; Project Identifying Information
                </button>
                <div class="dropdown-menu p-2" style="width: 230px">
                    <div style="font-size: 11.5px">Locality</div>
                    <div style=" line-height: 20%;"><br></div>
                    <div style="width: 160px; height: 80px; overflow-y: scroll;">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="accomackCheck">
                                <label class="form-check-label button-font" for="accomackCheck">
                                    Accomack
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="albemarleCheck">
                                <label class="form-check-label button-font" for="albemarleCheck">
                                    Albemarle
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="ameliaCheck">
                                <label class="form-check-label button-font" for="ameliaCheck">
                                    Amelia
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="amherstCheck">
                                <label class="form-check-label button-font" for="amherstCheck">
                                    Amherst
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="appomattoxCheck">
                                <label class="form-check-label button-font" for="appomattoxCheck">
                                    Appomattox
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="augustaCheck">
                                <label class="form-check-label button-font" for="augustaCheck">
                                    Augusta
                                </label>
                            </div>
                            <br>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="bathCheck">
                                <label class="form-check-label button-font" for="bathCheck">
                                    Bath
                                </label>
                            </div>
                            <br>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="bedfordCheck">
                                <label class="form-check-label button-font" for="bedfordCheck">
                                    Bedford
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="botetourtCheck">
                                <label class="form-check-label button-font" for="botetourtCheck">
                                    Botetourt
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="brunswickCheck">
                                <label class="form-check-label button-font" for="brunswickCheck">
                                    Brunswick
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="buchananCheck">
                                <label class="form-check-label button-font" for="buchananCheck">
                                    Buchanan
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="buckinghamCheck">
                                <label class="form-check-label button-font" for="buckinghamCheck">
                                    Buckingham
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="colonialBeachPointCheck">
                                <label class="form-check-label button-font" for="colonialBeachPointCheck">
                                    Colonial Beach
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type= "checkbox" value="" id="westPointCheck">
                                <label class="form-check-label button-font" for="westPointCheck">
                                    West Point
                                </label>
                            </div>
                    </div>
                </div>
            </div>

            <div style="line-height: 75%"><br></div>

            <div class="dropdown">
                <button class="btn btn-sm dropdown-toggle" style="width: 240px; text-align: left; border: 0.8px solid #000000; background-color: #ffffff;" data-toggle="dropdown">
                    &#160; Location and Site Details
                </button>
            </div>

            <div style="line-height: 75%"><br></div>

            <div class="dropdown">
                <button class="btn btn-sm dropdown-toggle" style="width: 240px; text-align: left; border: 0.8px solid #000000; background-color: #ffffff;" data-toggle="dropdown">
                    &#160; Permit Information
                </button>
                <div class="dropdown-menu p-2" style="width: 230px">
                    <div style="font-size: 11.5px">Local Permit Decision Date</div>
                    <div style=" line-height: 20%;"><br></div>
                        <input style="width: 115px; font-size: 12px;" type="date" id="dateInput" name="minInput">
                    <div style=" line-height: 80%;"><br></div>
                </div>
            </div>

            <div style="line-height: 75%"><br></div>

            <div class="dropdown">
                <button class="btn btn-sm dropdown-toggle" style="width: 240px; text-align: left; border: 0.8px solid #000000; background-color: #ffffff;" data-toggle="dropdown">
                    &#160; Project Features
                </button>
            </div>

            <br>

            <button id="columnFilterButton" class="btn btn-light btn-sm" style="margin-right: 20px">Apply Filter(s)</button>

          </div>
          <div class="col-9">
            <style> #map { height: 400px; width: 818px } </style>
            <p class="card-text" id="map"></p>
          </div>
        </div>
    </div>

    <br>

    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                </div>
            </div>
            <br>
            <div class="card">
                <div class="card-body">
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                </div>
            </div>
            <br>
            <div class="card">
                <div class="card-body">
                </div>
            </div>
        </div>
    </div>

    <br>

    <script>
        var map = L.map('map').setView([38.2, -79.2569], 7)

        let data = JSON.parse(document.getElementById('data_json').textContent)

        var mapBase = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 20,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        })

        var projectMarkers = L.layerGroup();

        data.forEach(data => {
            if (data.longitude !== null && data.latitude !== null
                && data.longitude.indexOf(';') == -1 && data.latitude.indexOf(';') == -1) {
                var projectMarker = L.marker([data.latitude, data.longitude])
                                            .on('click', function() {
                                                window.location.href ="/project/" + data.data_id
                                            })
                                            .on('mouseover', function() {
                                                    projectMarker.bindPopup(data.project_name).openPopup()
                                                })
                                            .on('mouseout', function() {
                                                projectMarker.closePopup()
                                            })
                
                projectMarkers.addLayer(projectMarker)
            }
        })

        mapBase.addTo(map)
        projectMarkers.addTo(map)
    </script>
{% endblock content %}
