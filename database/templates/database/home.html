{% extends "database/base.html" %}
{% block content %}
    <br><br>

    {{ data|json_script:"data_json" }}

    <div class="container">
        <div class="row">
          <div class="col">
          </div>
          <div class="col-9">
            <style> #map { height: 400px; } </style>
            <p class="card-text" id="map"></p>
          </div>
        </div>
    </div>

    <br>

    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                </div>
            </div>
            <br>
            <div class="card">
                <div class="card-body">
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <div class="card-body">
                </div>
            </div>
        </div>
    </div>

    <br>

    <script>
        var map = L.map('map').setView([38.2, -79.2569], 7)

        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 20,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map)

        let data = JSON.parse(document.getElementById('data_json').textContent)

        data.forEach(data => {
            if (data.longtiude !== null && data.latitude !== null) {
                L.marker([data.latitude, data.longitude]).bindPopup(data.project_name).addTo(map)
            }
        })
    </script>
{% endblock content %}
